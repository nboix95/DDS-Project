---
title: "Prácitca DDS"
output: html_document
---
##### Data Driven Security - ed. 7 Master in Cybersecurity Management - UPC School
##### **GRUPO A** - Autores: Dídac Caminero García y Neus Boix Colomer
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
* 1. Introducción y definiciónde la pregunta
* 2. Definición del conjunto de datos
* 3. Determinación de los datos accesibles
    + 3.1 Obtención de los datos elegantes
* 4. Análisis de exploración de datos y gráficos
* 5. Conclusiones

## 1. Introducción y definición de la pregunta

El objetivo de la práctica es evidenciar las posibles webs vulnerables respecto su orígen (país) y época del año.

En este proyecto, se ha planteado como punto de partida, qué características son las principales para detectar que una web sea propensa a ser vulnerada.

A partir de aquí, se han realizado varias búsquedas de bases de datos, hasta dar con la fuente de datos definitiva: http://www.malwaredomains.com/. En esta se han encontrado ficheros donde aparecen webs vulneradas en estos tres últimos años, la mayoría de ellas a causa de phishing. Para su análisis se ha tratado con en programa RStudio.

El repositorio que se ha utilizado para la descarga y modificación de datos y los cálculos pertinentes es el Github mediante el intermediario GitKraken.

En este se encuentra: el informe en Rmd, el código (junto con los packages aplicados) y cálculos intermedios de análisis. 

* https://github.com/nboix95/DDS-Project.

## 2. Definición del conjunto de datos
A la hora de definir el conjunto de datos, se ha pensado qué tipo de información es interesante para determinar las propiedades de una página web. Esta se define en los siguientes puntos: 

- **Domain**: dominio del cual pertenecen. 
- **Fecha**: fecha en el que se realizó el ataque.
- **IP**: IP correspondiente a cada dominio.
- **Proveedor**,**Tipología servidor** y **Autor dominio**: whois del dominio.
- **Origen**: país de donde proceden.

## 3. Determinación de los datos accesibles

Una vez se han definido los datos, se ha establecido una relación entre ellos, para así poder aplicar un modelo estadísitico lo más exacto posible. 

Los objetivos principales son: 

1. Relacionar qué **países** son los más **atacados**, en cuanto a webs.
2. Qué **proveedores** suelen ser los **más vulnerables**. 
3. Establecer en qué **épocas del año** suelen haber **más phishings**.

### 3.1 Obtención de los datos elegantes

A continuación, se describen los pasos que se han llevado a cabo para la obtención de los datos. 

En primer lugar, se han instalado las siguientes librerias: 

Package | Description
------- | -----------
iptools | Obtención de la IP de un dominio
stringr | Operaciones con diferentes tipologias de caracteres
rgeolocate | Geolocalización de las IP's
data.table | Modificar tablas de las bases de datos
plyr | Dividir, aplicar y cambiar bases de datos
ggplot2 | Creación de gráficos personalizados
rlang | Tratar diferentes tipos de bases de datos
plotly | Creación de gráficos interactivos

Posteriormente, se ha descargado la página web que contiene todos los enlaces a los archivos .txt que contienen los datos. Una vez descargada la página, era necesario extraer todos los enlaces que llevasen a archivos .txt con un formato determinado, así que se llevaron a cabo varios pases de regex con distintas cadenas para finalmente formar un vector de enlaces a los archivos que contienen los datos.

Una vez generado el vector, se procedió a iterar sobre el mismo descargando cada archivo y metiendo cada línea en una línea del dataframe principal. Dado que los archivos eran texto plano con los campos separados por espacios, fué trivial parsear cada línea para separar los datos en las columnas adecadas.

Fué necesario incluir más columnas de las necesarias ya que había ciertos archivos que tenían un mayor número de columnas. 

Una vez todos los enlaces fueron parseados y su información añadida al dataframe principal, se procedió al saneamiento de la información, eliminando columnas sobrantes o mal parseadas y descartando líneas que no cumplían con los criterios de información que eran necesarios para el proyecto.

Teniendo así los datos ordenados, saneados y en un formato homogéneo, se pasó a iterar sobre el dataframe en busca de las IP's relacionadas con cada uno de los dominios, añadiéndolas al dataframe en una nueva columna.


## 4. Análisis de exploración de datos y gráficos

A continuación se analizan los países que más webs han sido vulneradas a nivel
mundial.

En el siguiente mapa de calor se muestra la densidad de dichas webs. Aparentemente los paises que tienen más webs atacadas son EEUU y Ásia:

**Figura 1** - Mapa de calor de webs vulneradas

![](C:\Users\usuario\Desktop\MASTER\Data Driven Security\RStudio\DDS-Project\Mapa.png) 

Se analizan cuales son los 10 paises que tienen más webs vulneradas. Para obtener esta relación se ha calculado la frecuencia de estos. 

**Figura 2** - Vulnerabilidades por país

![](C:\Users\usuario\Desktop\MASTER\Data Driven Security\RStudio\DDS-Project\Countriesfreq.png) 

Como conclusión se puede afirmar que el país con más webs vulneradas, según la fuente de datos, es EEUU.

El siguiente paso es visualizar las época del año donde hay más ataques a webs.

**Figura 3** - Picos de ataques entre 2013 y 2018

![](C:\Users\usuario\Desktop\MASTER\Data Driven Security\RStudio\DDS-Project\Periodo ataques.png) 

Como se observa, se distinguen 10 principales picos de máxima cantidad de ataques a webs. En el siguiente gráfico se muestra que a principios de año, Enero-Febrero, es donde más cantidad de webs son vulneradas. 

**Figura 4** - Fechas coincidentes con la época de más ataques

![](C:\Users\usuario\Desktop\MASTER\Data Driven Security\RStudio\DDS-Project\Picosfechas.png) 


## 5.Conclusiones

Como conclusiones y obteniendo así la respuesta a la pregunta, se puede constatar que: 

1. Los paises más propensos a ser vulnerados vía webs, son: EEUU, Alemania y Reino Unido. 
2. En cuanto los proveedores que suelen ser los más vulnerables, no se ha podido analizar ya que todas las opciones que se han presentado son de pago. El package que ofrece una extensa información sobre el whois del dominio es: domaintools.
3. Las épocas donde suelen tener más phishings son a principios años: entre Enero y Febrero.
